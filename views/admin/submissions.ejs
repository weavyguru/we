<div class="container mx-auto px-6 py-12">
  <div class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-4xl font-bold text-gray-900 mb-2">Survey Submissions</h1>
        <p class="text-gray-600">View all responses from submitted surveys</p>
      </div>
      <a href="/admin/survey" class="gradient-bg text-white px-6 py-3 rounded hover:opacity-90 transition">
        <i class="fas fa-arrow-left mr-2"></i> Back to Questions
      </a>
    </div>
  </div>

  <!-- Summary Section -->
  <% if (responses.length > 0) { %>
    <%
      const latestSubmission = responses[0];
      const oldestSubmission = responses[responses.length - 1];
    %>
    <div class="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6 mb-6">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="text-center md:text-left">
          <p class="text-sm text-gray-600 mb-1">Total Submissions</p>
          <p class="text-3xl font-bold text-gray-900"><%= responses.length %></p>
        </div>
        <div class="text-center md:text-left">
          <p class="text-sm text-gray-600 mb-1">Latest Submission</p>
          <p class="text-lg font-semibold text-gray-900"><%= new Date(latestSubmission.completedAt).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) %></p>
        </div>
        <div class="text-center md:text-left">
          <p class="text-sm text-gray-600 mb-1">First Submission</p>
          <p class="text-lg font-semibold text-gray-900"><%= new Date(oldestSubmission.completedAt).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) %></p>
        </div>
      </div>
    </div>
  <% } %>

  <!-- Submissions List -->
  <div class="space-y-6">
    <% if (responses.length === 0) { %>
      <div class="bg-gray-50 border border-gray-200 rounded-lg p-8 text-center text-gray-500">
        <i class="fas fa-inbox text-4xl mb-3"></i>
        <p>No submissions yet.</p>
      </div>
    <% } else { %>
      <% responses.forEach((response, index) => { %>
        <sl-details class="bg-white border border-gray-200 rounded-lg shadow-sm submission-details">
          <div slot="summary" class="flex items-center justify-between py-2 pr-8">
            <div>
              <h3 class="text-lg font-semibold text-gray-900">Submission #<%= responses.length - index %> | <%= new Date(response.completedAt).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %> <%= new Date(response.completedAt).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }) %></h3>
            </div>
          </div>

          <!-- Expanded Content -->
          <div class="pt-4 border-t border-gray-200">
            <p class="text-sm text-gray-500 mb-4">Session ID: <%= response.sessionId %></p>

            <!-- Answers -->
            <div class="space-y-4">
              <% response.answers.forEach(answer => { %>
                <div class="bg-gray-50 rounded-lg p-4">
                  <p class="text-sm font-semibold text-gray-700 mb-2">
                    <%= answer.questionId ? answer.questionId.questionText : 'Question not found' %>
                  </p>
                  <p class="text-gray-900">
                    <%= answer.answer %>
                  </p>
                </div>
              <% }) %>
            </div>
          </div>
        </sl-details>
      <% }) %>
    <% } %>
  </div>
</div>
